!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.barbaRouter={})}(this,function(t){"use strict";var e=p,n=c,r=function(t,e){return f(c(t,e))},o=f,i=d,a="/",s="./",u=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function c(t,e){for(var n,r,o=[],i=0,c=0,f="",l=e&&e.delimiter||a,d=e&&e.delimiters||s,p=!1;null!==(n=u.exec(t));){var v=n[0],m=n[1],g=n.index;if(f+=t.slice(c,g),c=g+v.length,m)f+=m[1],p=!0;else{var y="",w=t[c],C=n[2],x=n[3],b=n[4],T=n[5];if(!p&&f.length){var E=f.length-1;d.indexOf(f[E])>-1&&(y=f[E],f=f.slice(0,E))}f&&(o.push(f),f="",p=!1);var L=""!==y&&void 0!==w&&w!==y,_="+"===T||"*"===T,k="?"===T||"*"===T,P=y||l,R=x||b;o.push({name:C||i++,prefix:y,delimiter:P,optional:k,repeat:_,partial:L,pattern:R?(r=R,r.replace(/([=!:$/()])/g,"\\$1")):"[^"+h(P)+"]+?"})}}return(f||c<t.length)&&o.push(f+t.substr(c)),o}function f(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,r){for(var o="",i=r&&r.encode||encodeURIComponent,a=0;a<t.length;a++){var s=t[a];if("string"!=typeof s){var u,c=n?n[s.name]:void 0;if(Array.isArray(c)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but got array');if(0===c.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var f=0;f<c.length;f++){if(u=i(c[f]),!e[a].test(u))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'"');o+=(0===f?s.prefix:s.delimiter)+u}}else if("string"!=typeof c&&"number"!=typeof c&&"boolean"!=typeof c){if(!s.optional)throw new TypeError('Expected "'+s.name+'" to be '+(s.repeat?"an array":"a string"));s.partial&&(o+=s.prefix)}else{if(u=i(String(c)),!e[a].test(u))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+u+'"');o+=s.prefix+u}}else o+=s}return o}}function h(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function l(t){return t&&t.sensitive?"":"i"}function d(t,e,n){for(var r=(n=n||{}).strict,o=!1!==n.end,i=h(n.delimiter||a),u=n.delimiters||s,c=[].concat(n.endsWith||[]).map(h).concat("$").join("|"),f="",d=!1,p=0;p<t.length;p++){var v=t[p];if("string"==typeof v)f+=h(v),d=p===t.length-1&&u.indexOf(v[v.length-1])>-1;else{var m=h(v.prefix),g=v.repeat?"(?:"+v.pattern+")(?:"+m+"(?:"+v.pattern+"))*":v.pattern;e&&e.push(v),v.optional?v.partial?f+=m+"("+g+")?":f+="(?:"+m+"("+g+"))?":f+=m+"("+g+")"}}return o?(r||(f+="(?:"+i+")?"),f+="$"===c?"$":"(?="+c+")"):(r||(f+="(?:"+i+"(?="+c+"))?"),d||(f+="(?="+i+"|"+c+")")),new RegExp("^"+f,l(n))}function p(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,n){for(var r=[],o=0;o<t.length;o++)r.push(p(t[o],e,n).source);return new RegExp("(?:"+r.join("|")+")",l(n))}(t,e,n):(r=e,d(c(t,o=n),r,o));var r,o}e.parse=n,e.compile=r,e.tokensToFunction=o,e.tokensToRegExp=i;var v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function m(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function g(t){for(var e=g.options,n=e.parser[e.strictMode?"strict":"loose"].exec(t),r={},o=14;o--;)r[e.key[o]]=n[o]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(t,n,o){n&&(r[e.q.name][n]=o)}),r}function y(t){try{return decodeURIComponent(t)}catch(t){log("decodeParam error")}}g.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var w,C=(w=(w={sensitive:!1,strict:!1,end:!1})||{},function(t){var n=[],r=e(t,n,w);return function(t,e){var o=r.exec(t);if(!o)return!1;e=e||{};for(var i=void 0,a=void 0,s=0;s<n.length;s+=1)i=n[s],(a=o[s+1])&&(e[i.name]=y(a),i.repeat&&(e[i.name]=e[i.name].split(i.delimiter)));return e}}),x=function(t){var e=g(t),n=e.anchor,r=e.host,o=e.path,i=e.queryKey,a=e.source,s=o.split("/").filter(function(t){return t.length});return{isRoot:"/"===o,hash:n,host:r,path:o,segments:s,slug:s[s.length-1],source:a,query:i,length:s.length}};"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var b,T=(function(t,e){var n;n=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=t,n.c=e,n.p="http://localhost:8080/dist",n(0)}([function(t,e,n){"function"!=typeof Promise&&(window.Promise=n(1));var r={version:"1.0.0",BaseTransition:n(4),BaseView:n(6),BaseCache:n(8),Dispatcher:n(7),HistoryManager:n(9),Pjax:n(10),Prefetch:n(13),Utils:n(5)};t.exports=r},function(t,e,n){(function(e){!function(n){var r=setTimeout;function o(){}var i="function"==typeof e&&e||function(t){r(t,0)},a=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};function s(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function u(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void f(e.promise,t)}c(e.promise,r)}else(1===t._state?c:f)(e.promise,t._value)})):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof s)return t._state=3,t._value=e,void h(t);if("function"==typeof n)return void l((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,h(t)}catch(e){f(t,e)}var r,o}function f(t,e){t._state=2,t._value=e,h(t)}function h(t){2===t._state&&0===t._deferreds.length&&i(function(){t._handled||a(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)u(t,t._deferreds[e]);t._deferreds=null}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,c(e,t))},function(t){n||(n=!0,f(e,t))})}catch(t){if(n)return;n=!0,f(e,t)}}s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var n=new this.constructor(o);return u(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},s.all=function(t){var e=Array.prototype.slice.call(t);return new s(function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){o(i,t)},n)}e[i]=a,0==--r&&t(e)}catch(t){n(t)}}for(var i=0;i<e.length;i++)o(i,e[i])})},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(t){return new s(function(e,n){n(t)})},s.race=function(t){return new s(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},s._setImmediateFn=function(t){i=t},s._setUnhandledRejectionFn=function(t){a=t},void 0!==t&&t.exports?t.exports=s:n.Promise||(n.Promise=s)}(this)}).call(e,n(2).setImmediate)},function(t,e,n){(function(t,r){var o=n(3).nextTick,i=Function.prototype.apply,a=Array.prototype.slice,s={},u=0;function c(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new c(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new c(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var n=u++,r=!(arguments.length<2)&&a.call(arguments,1);return s[n]=!0,o(function(){s[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof r?r:function(t){delete s[t]}}).call(e,n(2).setImmediate,n(2).clearImmediate)},function(t,e){var n,r,o=t.exports={};!function(){try{n=setTimeout}catch(t){n=function(){throw new Error("setTimeout is not defined")}}try{r=clearTimeout}catch(t){r=function(){throw new Error("clearTimeout is not defined")}}}();var i,a=[],s=!1,u=-1;function c(){s&&i&&(s=!1,i.length?a=i.concat(a):u=-1,a.length&&f())}function f(){if(!s){var t=n(c);s=!0;for(var e=a.length;e;){for(i=a,a=[];++u<e;)i&&i[u].run();u=-1,e=a.length}i=null,s=!1,r(t)}}function h(t,e){this.fun=t,this.array=e}function l(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];a.push(new h(t,e)),1!==a.length||s||n(f,0)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=l,o.addListener=l,o.once=l,o.off=l,o.removeListener=l,o.removeAllListeners=l,o.emit=l,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){var r=n(5),o={oldContainer:void 0,newContainer:void 0,newContainerLoading:void 0,extend:function(t){return r.extend(this,t)},init:function(t,e){var n=this;return this.oldContainer=t,this._newContainerPromise=e,this.deferred=r.deferred(),this.newContainerReady=r.deferred(),this.newContainerLoading=this.newContainerReady.promise,this.start(),this._newContainerPromise.then(function(t){n.newContainer=t,n.newContainerReady.resolve()}),this.deferred.promise},done:function(){this.oldContainer.parentNode.removeChild(this.oldContainer),this.newContainer.style.visibility="visible",this.deferred.resolve()},start:function(){}};t.exports=o},function(t,e){var n={getCurrentUrl:function(){return window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search},cleanLink:function(t){return t.replace(/#.*/,"")},xhrTimeout:5e3,xhr:function(t){var e=this.deferred(),n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4===n.readyState)return 200===n.status?e.resolve(n.responseText):e.reject(new Error("xhr: HTTP code is not 200"))},n.ontimeout=function(){return e.reject(new Error("xhr: Timeout exceeded"))},n.open("GET",t),n.timeout=this.xhrTimeout,n.setRequestHeader("x-barba","yes"),n.send(),e.promise},extend:function(t,e){var n=Object.create(t);for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n},deferred:function(){return new function(){this.resolve=null,this.reject=null,this.promise=new Promise(function(t,e){this.resolve=t,this.reject=e}.bind(this))}},getPort:function(t){var e=void 0!==t?t:window.location.port,n=window.location.protocol;return""!=e?parseInt(e):"http:"===n?80:"https:"===n?443:void 0}};t.exports=n},function(t,e,n){var r=n(7),o=n(5),i={namespace:null,extend:function(t){return o.extend(this,t)},init:function(){var t=this;r.on("initStateChange",function(e,n){n&&n.namespace===t.namespace&&t.onLeave()}),r.on("newPageReady",function(e,n,r){t.container=r,e.namespace===t.namespace&&t.onEnter()}),r.on("transitionCompleted",function(e,n){e.namespace===t.namespace&&t.onEnterCompleted(),n&&n.namespace===t.namespace&&t.onLeaveCompleted()})},onEnter:function(){},onEnterCompleted:function(){},onLeave:function(){},onLeaveCompleted:function(){}};t.exports=i},function(t,e){var n={events:{},on:function(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)},off:function(t,e){t in this.events!=!1&&this.events[t].splice(this.events[t].indexOf(e),1)},trigger:function(t){if(t in this.events!=!1)for(var e=0;e<this.events[t].length;e++)this.events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}};t.exports=n},function(t,e,n){var r=n(5),o={data:{},extend:function(t){return r.extend(this,t)},set:function(t,e){this.data[t]=e},get:function(t){return this.data[t]},reset:function(){this.data={}}};t.exports=o},function(t,e){var n={history:[],add:function(t,e){e||(e=void 0),this.history.push({url:t,namespace:e})},currentStatus:function(){return this.history[this.history.length-1]},prevStatus:function(){var t=this.history;return t.length<2?null:t[t.length-2]}};t.exports=n},function(t,e,n){var r=n(5),o=n(7),i=n(11),a=n(8),s=n(9),u={Dom:n(12),History:s,Cache:a,cacheEnabled:!0,transitionProgress:!1,ignoreClassLink:"no-barba",start:function(){this.init()},init:function(){var t=this.Dom.getContainer();this.Dom.getWrapper().setAttribute("aria-live","polite"),this.History.add(this.getCurrentUrl(),this.Dom.getNamespace(t)),o.trigger("initStateChange",this.History.currentStatus()),o.trigger("newPageReady",this.History.currentStatus(),{},t,this.Dom.currentHTML),o.trigger("transitionCompleted",this.History.currentStatus()),this.bindEvents()},bindEvents:function(){document.addEventListener("click",this.onLinkClick.bind(this)),window.addEventListener("popstate",this.onStateChange.bind(this))},getCurrentUrl:function(){return r.cleanLink(r.getCurrentUrl())},goTo:function(t){window.history.pushState(null,null,t),this.onStateChange()},forceGoTo:function(t){window.location=t},load:function(t){var e,n=r.deferred(),o=this;return(e=this.Cache.get(t))||(e=r.xhr(t),this.Cache.set(t,e)),e.then(function(t){var e=o.Dom.parseResponse(t);o.Dom.putContainer(e),o.cacheEnabled||o.Cache.reset(),n.resolve(e)},function(){o.forceGoTo(t),n.reject()}),n.promise},getHref:function(t){if(t)return t.getAttribute&&"string"==typeof t.getAttribute("xlink:href")?t.getAttribute("xlink:href"):"string"==typeof t.href?t.href:void 0},onLinkClick:function(t){for(var e=t.target;e&&!this.getHref(e);)e=e.parentNode;if(this.preventCheck(t,e)){t.stopPropagation(),t.preventDefault(),o.trigger("linkClicked",e,t);var n=this.getHref(e);this.goTo(n)}},preventCheck:function(t,e){if(!window.history.pushState)return!1;var n=this.getHref(e);return!(!e||!n)&&(!(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)&&((!e.target||"_blank"!==e.target)&&(window.location.protocol===e.protocol&&window.location.hostname===e.hostname&&(r.getPort()===r.getPort(e.port)&&(!(n.indexOf("#")>-1)&&((!e.getAttribute||"string"!=typeof e.getAttribute("download"))&&(r.cleanLink(n)!=r.cleanLink(location.href)&&!e.classList.contains(this.ignoreClassLink))))))))},getTransition:function(){return i},onStateChange:function(){var t=this.getCurrentUrl();if(this.transitionProgress&&this.forceGoTo(t),this.History.currentStatus().url===t)return!1;this.History.add(t);var e=this.load(t),n=Object.create(this.getTransition());this.transitionProgress=!0,o.trigger("initStateChange",this.History.currentStatus(),this.History.prevStatus());var r=n.init(this.Dom.getContainer(),e);e.then(this.onNewContainerLoaded.bind(this)),r.then(this.onTransitionEnd.bind(this))},onNewContainerLoaded:function(t){this.History.currentStatus().namespace=this.Dom.getNamespace(t),o.trigger("newPageReady",this.History.currentStatus(),this.History.prevStatus(),t,this.Dom.currentHTML)},onTransitionEnd:function(){this.transitionProgress=!1,o.trigger("transitionCompleted",this.History.currentStatus(),this.History.prevStatus())}};t.exports=u},function(t,e,n){var r=n(4).extend({start:function(){this.newContainerLoading.then(this.finish.bind(this))},finish:function(){document.body.scrollTop=0,this.done()}});t.exports=r},function(t,e){var n={dataNamespace:"namespace",wrapperId:"barba-wrapper",containerClass:"barba-container",currentHTML:document.documentElement.innerHTML,parseResponse:function(t){this.currentHTML=t;var e=document.createElement("div");e.innerHTML=t;var n=e.querySelector("title");return n&&(document.title=n.textContent),this.getContainer(e)},getWrapper:function(){var t=document.getElementById(this.wrapperId);if(!t)throw new Error("Barba.js: wrapper not found!");return t},getContainer:function(t){if(t||(t=document.body),!t)throw new Error("Barba.js: DOM not ready!");var e=this.parseContainer(t);if(e&&e.jquery&&(e=e[0]),!e)throw new Error("Barba.js: no container found");return e},getNamespace:function(t){return t&&t.dataset?t.dataset[this.dataNamespace]:t?t.getAttribute("data-"+this.dataNamespace):null},putContainer:function(t){t.style.visibility="hidden",this.getWrapper().appendChild(t)},parseContainer:function(t){return t.querySelector("."+this.containerClass)}};t.exports=n},function(t,e,n){var r=n(5),o=n(10),i={ignoreClassLink:"no-barba-prefetch",init:function(){if(!window.history.pushState)return!1;document.body.addEventListener("mouseover",this.onLinkEnter.bind(this)),document.body.addEventListener("touchstart",this.onLinkEnter.bind(this))},onLinkEnter:function(t){for(var e=t.target;e&&!o.getHref(e);)e=e.parentNode;if(e&&!e.classList.contains(this.ignoreClassLink)){var n=o.getHref(e);if(o.preventCheck(t,e)&&!o.Cache.get(n)){var i=r.xhr(n);o.Cache.set(n,i)}}}};t.exports=i}])},t.exports=n()}(b={exports:{}},b.exports),b.exports),E=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var L=T.Pjax,_=T.Dispatcher,k=T.BaseTransition,P=T.Prefetch;t.Barba=T,t.Pjax=L,t.default=function t(e){var n,r=this,o=e.routes,i=e.onChange,a=void 0===i?[]:i,s=e.onReady,u=void 0===s?[]:s,c=e.onComplete,f=void 0===c?[]:c,h=e.navigation,l=void 0===h?["body"]:h,d=e.transitionOnLoad,p=void 0===d||d,g=e.currentClass,y=e.currentParentClass;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.syncEvents=function(){_.on("linkClicked",r.routeRequest),_.on("initStateChange",r.routeChange),_.on("newPageReady",r.routeReady),_.on("transitionCompleted",r.routeComplete)},this.linkClicked=!0,this.matchRoute=function(t){r.history.previous=r.history.current,r.history.current=r.findRoute(t)},this.history={previous:null,current:null},this.routeRequest=function(t){var e=t.href;r.linkClicked=!0,r.matchRoute(e)},this.getData=function(){var t=r.history.current,e=t.data,n=t.route;return{from:r.history.previous?E({},r.history.previous.data,{name:r.history.previous.route.name}):null,to:E({},e,{name:n.name})}},this.routeChange=function(){r.linkClicked||r.matchRoute(window.location.href);var t=r.getData(),e=t.from,n=t.to;r.playOnLoad&&(r.playOnLoad=!1,r.history.current.route.view.onEnter({from:e,to:n,next:function(){}})),r.onChange.forEach(function(t){return t({from:e,to:n})})},this.routeReady=function(t,e,n,o){var i=r.getData(),a=i.from,s=i.to;r.onReady.forEach(function(r){return r({from:a,to:s,currentStatus:t,prevStatus:e,HTMLElementContainer:n,newPageRawHTML:o})})},this.routeComplete=function(){r.linkClicked=!1;var t=r.getData(),e=t.from,n=t.to;r.navLinks(n.source),r.onComplete.forEach(function(t){return t({from:e,to:n})})},this.transitionManager=function(){var t=r;L.getTransition=function(){return k.extend({start:function(){Promise.all([this.newContainerLoading,this.pageExit()]).then(this.pageEnter.bind(this))},pageExit:function(){return new Promise(function(e){var n=t.history.previous.route.view,r=t.getData(),o=r.from,i=r.to;n.onLeave({from:o,to:i,next:e})})},pageEnter:function(){var e=t.history.current.route.view,n=t.getData(),r=n.from,o=n.to;e.onEnter({from:r,to:o,next:this.done.bind(this)})},done:function(t){this.oldContainer.parentNode.removeChild(this.oldContainer),this.newContainer.style.visibility="visible",Promise.resolve(this.deferred.resolve()).then(t)}})}},this.start=function(){r.history.current=r.findRoute(window.location.href),r.transitionManager(),r.syncEvents(),L.start(),P.init()},this.routes=function t(e){return e.reduce(function(e,n){var r=n.path,o=n.view,i=n.children,a=n.name,s=r,u=[];if(u.push({path:r,view:o,name:a}),i){var c=Array.isArray(i)?i:[i],f="/"===s?"":"/";u.push.apply(u,m(t(c).map(function(t){return v({},t,{path:s+f+t.path})})))}return e.push.apply(e,u),e},[])}(o),this.findRoute=(n=this.routes,function(t){var e=x(t),r=e.path,o=n.filter(function(t){var e=t.path;return C(e)(r)});return 1===o.length&&"/"!==r?{route:n.find(function(t){return"*"===t.path}),data:e}:{route:o[o.length-1],data:e}}),this.navLinks=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{currentClass:"active",currentParentClass:"pappa-active"},n=e.currentClass,r=e.currentParentClass,o=t.reduce(function(t,e){return[].concat(m(t),m(document.querySelectorAll(e+" a")))},[]).map(function(t){var e=t.href,n=x(e);return{$anchor:t,segments:n.segments,slug:n.slug,path:n.path}});return function(t){var e=x(t),i=e.path,a=e.segments,s=e.length;return o.filter(function(t){var e=t.$anchor,o=t.path,u=t.segments;e.classList.remove(n,r);var c=a.slice(0,s-1),f=u.find(function(t,e){return t===c[e]});return o===i||f}).map(function(t){var e=t.$anchor,o=e.pathname===i?n:r;e.classList.add(o)})}}(l,{currentClass:g,currentParentClass:y}),log(this.routes),this.playOnLoad=p,this.onChange=a,this.onReady=u,this.onComplete=f},Object.defineProperty(t,"__esModule",{value:!0})});
